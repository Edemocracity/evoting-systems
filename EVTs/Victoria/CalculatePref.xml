<WorkflowService mc:Ignorable="sap" ConfigurationName="CalculatePref" sap:VirtualizedContainerService.HintSize="2345,3738" Name="CalculatePref" mva:VisualBasic.Settings="Assembly references and imported namespaces serialized as XML namespaces" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/servicemodel" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="clr-namespace:Microsoft.VisualBasic;assembly=System" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:p="http://tempuri.org/" xmlns:p1="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:s1="clr-namespace:System;assembly=System" xmlns:s2="clr-namespace:System;assembly=System.Xml" xmlns:s3="clr-namespace:System;assembly=System.Core" xmlns:s4="clr-namespace:System;assembly=System.ServiceModel" xmlns:sa="clr-namespace:System.Activities;assembly=System.Activities" xmlns:sad="clr-namespace:System.Activities.Debugger;assembly=System.Activities" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System" xmlns:scg1="clr-namespace:System.Collections.Generic;assembly=System.ServiceModel" xmlns:scg2="clr-namespace:System.Collections.Generic;assembly=System.Core" xmlns:scg3="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:sl="clr-namespace:System.Linq;assembly=System.Core" xmlns:ssa="clr-namespace:System.ServiceModel.Activities;assembly=System.ServiceModel.Activities" xmlns:ssx="clr-namespace:System.ServiceModel.XamlIntegration;assembly=System.ServiceModel" xmlns:st="clr-namespace:System.Text;assembly=mscorlib" xmlns:vcb="clr-namespace:Vec.ComputerCount.BL;assembly=Vec.ComputerCount.BL" xmlns:vce="clr-namespace:Vec.Common.Entities;assembly=Vec.Common.Entities" xmlns:vce1="clr-namespace:Vec.ComputerCount.Entities;assembly=Vec.ComputerCount.Entities" xmlns:vfc="clr-namespace:Vec.Framework.Core;assembly=Vec.Framework.Core" xmlns:vscw="clr-namespace:Vec.Services.ComputerCount.WF;assembly=Vec.Services.ComputerCount.WF" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <p1:Sequence DisplayName="Sequential Service" sad:XamlDebuggerXmlReader.FileName="C:\Projects\Turing\Trunk\Dev\ComputerCount\Vec.Services.ComputerCount.WF\CalculatePref.xamlx" sap:VirtualizedContainerService.HintSize="2315,3708" mva:VisualBasic.Settings="Assembly references and imported namespaces serialized as XML namespaces">
    <p1:Sequence.Variables>
      <p1:Variable x:TypeArguments="vce1:MResolveRequest" Name="ResolveTieRequest" />
      <p1:Variable x:TypeArguments="vscw:ProcessStruct" Name="Process" />
      <p1:Variable x:TypeArguments="scg3:List(vce1:MCandidate)" Name="Excluded" />
    </p1:Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg3:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <p1:Assign sap:VirtualizedContainerService.HintSize="2293,57">
      <p1:Assign.To>
        <p1:OutArgument x:TypeArguments="vscw:ProcessStruct">[Process]</p1:OutArgument>
      </p1:Assign.To>
      <p1:Assign.Value>
        <p1:InArgument x:TypeArguments="vscw:ProcessStruct">[New ProcessStruct()]</p1:InArgument>
      </p1:Assign.Value>
    </p1:Assign>
    <p1:Sequence sap:VirtualizedContainerService.HintSize="2293,1061">
      <p1:Sequence.Variables>
        <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handle1" />
      </p1:Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg3:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg3:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Receive x:Name="__ReferenceID0" CanCreateInstance="True" sap:VirtualizedContainerService.HintSize="418,86" OperationName="Initialise" ServiceContractName="p:ICalculate">
        <Receive.CorrelationInitializers>
          <RequestReplyCorrelationInitializer CorrelationHandle="[__handle1]" />
          <QueryCorrelationInitializer>
            <XPathMessageQuery x:Key="key1">
              <XPathMessageQuery.Namespaces>
                <ssx:XPathMessageContextMarkup>
                  <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                </ssx:XPathMessageContextMarkup>
              </XPathMessageQuery.Namespaces>sm:body()/xgSc:Initialise/xgSc:ProcessId</XPathMessageQuery>
          </QueryCorrelationInitializer>
        </Receive.CorrelationInitializers>
        <ReceiveParametersContent>
          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId">[Process.ProcessId]</p1:OutArgument>
          <p1:OutArgument x:TypeArguments="vce1:MCalculateRequest" x:Key="Request">[Process.Request]</p1:OutArgument>
        </ReceiveParametersContent>
      </Receive>
      <SendReply Request="{x:Reference __ReferenceID0}" DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="418,86" />
      <p1:TryCatch sap:VirtualizedContainerService.HintSize="418,685">
        <p1:TryCatch.Try>
          <p1:Sequence sap:VirtualizedContainerService.HintSize="400,507">
            <sap:WorkflowViewStateService.ViewState>
              <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg3:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <vscw:CreateCalculationObject4PR CalcMethod="[Vec.Common.Entities.CalculationMethod.Preferential]" CalculationId="[Process.ProcessId]" ConnectionString="[Process.Request.ConnectionString]" ElectionElectorateVacancyId="[Process.Request.SubElection]" ExcludedPositions="[Process.Request.ExcludedPositions]" sap:VirtualizedContainerService.HintSize="242,22" Result="[Process.CalculateObject]" TieMethod="[Process.Request.TieMethod]" Vacancies="[Process.Request.Vacancies]" />
            <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
              <p1:Assign.To>
                <p1:OutArgument x:TypeArguments="x:Boolean">[Process.CalculateObject.IsSavingData]</p1:OutArgument>
              </p1:Assign.To>
              <p1:Assign.Value>
                <p1:InArgument x:TypeArguments="x:Boolean">[Process.Request.SaveData]</p1:InArgument>
              </p1:Assign.Value>
            </p1:Assign>
            <p1:InvokeMethod sap:VirtualizedContainerService.HintSize="242,127" MethodName="LoadPapers">
              <p1:InvokeMethod.TargetObject>
                <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
              </p1:InvokeMethod.TargetObject>
            </p1:InvokeMethod>
            <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
              <p1:Assign.To>
                <p1:OutArgument x:TypeArguments="x:Int32">[Process.Response.Quota]</p1:OutArgument>
              </p1:Assign.To>
              <p1:Assign.Value>
                <p1:InArgument x:TypeArguments="x:Int32">[Process.CalculateObject.Quota]</p1:InArgument>
              </p1:Assign.Value>
            </p1:Assign>
          </p1:Sequence>
        </p1:TryCatch.Try>
        <p1:TryCatch.Catches>
          <p1:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,20">
            <sap:WorkflowViewStateService.ViewState>
              <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg3:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <p1:ActivityAction x:TypeArguments="s:Exception">
              <p1:ActivityAction.Argument>
                <p1:DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </p1:ActivityAction.Argument>
              <p1:Sequence sap:VirtualizedContainerService.HintSize="398,278">
                <sap:WorkflowViewStateService.ViewState>
                  <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg3:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                  <p1:Assign.To>
                    <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                  </p1:Assign.To>
                  <p1:Assign.Value>
                    <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Error]</p1:InArgument>
                  </p1:Assign.Value>
                </p1:Assign>
                <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                  <p1:Assign.To>
                    <p1:OutArgument x:TypeArguments="x:String">[Process.Response.Error]</p1:OutArgument>
                  </p1:Assign.To>
                  <p1:Assign.Value>
                    <p1:InArgument x:TypeArguments="x:String">[exception.Message]</p1:InArgument>
                  </p1:Assign.Value>
                </p1:Assign>
              </p1:Sequence>
            </p1:ActivityAction>
          </p1:Catch>
        </p1:TryCatch.Catches>
      </p1:TryCatch>
    </p1:Sequence>
    <p1:DoWhile sap:VirtualizedContainerService.HintSize="2293,2386" Condition="[Process.State &lt;&gt; CalculateState.Delivered And Process.State &lt;&gt; CalculateState.Cancel]">
      <p1:TryCatch sap:VirtualizedContainerService.HintSize="2267,2271">
        <p1:TryCatch.Try>
          <p1:Sequence sap:VirtualizedContainerService.HintSize="2249,2093">
            <sap:WorkflowViewStateService.ViewState>
              <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg3:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <p1:Pick sap:VirtualizedContainerService.HintSize="2227,1290">
              <p1:PickBranch DisplayName="Calculate Branch" sap:VirtualizedContainerService.HintSize="307,1244">
                <p1:PickBranch.Variables>
                  <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handle1" />
                </p1:PickBranch.Variables>
                <p1:PickBranch.Trigger>
                  <p1:Sequence sap:VirtualizedContainerService.HintSize="277,210">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <x:Reference>__ReferenceID1</x:Reference>
                  </p1:Sequence>
                </p1:PickBranch.Trigger>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="277,307">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:Assign sap:VirtualizedContainerService.HintSize="255,57">
                    <p1:Assign.To>
                      <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                    </p1:Assign.To>
                    <p1:Assign.Value>
                      <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Starting]</p1:InArgument>
                    </p1:Assign.Value>
                  </p1:Assign>
                  <SendReply DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="255,86">
                    <SendReply.Request>
                      <Receive x:Name="__ReferenceID1" sap:VirtualizedContainerService.HintSize="255,86" OperationName="Calculate" ServiceContractName="p:ICalculate">
                        <Receive.CorrelatesOn>
                          <XPathMessageQuery x:Key="key1">
                            <XPathMessageQuery.Namespaces>
                              <ssx:XPathMessageContextMarkup>
                                <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                              </ssx:XPathMessageContextMarkup>
                            </XPathMessageQuery.Namespaces>sm:body()/xgSc:Calculate/xgSc:ProcessId</XPathMessageQuery>
                        </Receive.CorrelatesOn>
                        <Receive.CorrelationInitializers>
                          <RequestReplyCorrelationInitializer CorrelationHandle="[__handle1]" />
                        </Receive.CorrelationInitializers>
                        <ReceiveParametersContent>
                          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId" />
                        </ReceiveParametersContent>
                      </Receive>
                    </SendReply.Request>
                    <SendParametersContent />
                  </SendReply>
                </p1:Sequence>
              </p1:PickBranch>
              <p1:PickBranch DisplayName="Get Status Branch" sap:VirtualizedContainerService.HintSize="307,1244">
                <p1:PickBranch.Variables>
                  <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handleGetStatus" />
                </p1:PickBranch.Variables>
                <p1:PickBranch.Trigger>
                  <p1:Sequence sap:VirtualizedContainerService.HintSize="277,210">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <x:Reference>__ReferenceID2</x:Reference>
                  </p1:Sequence>
                </p1:PickBranch.Trigger>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="277,404">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:Assign sap:VirtualizedContainerService.HintSize="255,57">
                    <p1:Assign.To>
                      <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.Response.State]</p1:OutArgument>
                    </p1:Assign.To>
                    <p1:Assign.Value>
                      <p1:InArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:InArgument>
                    </p1:Assign.Value>
                  </p1:Assign>
                  <p1:Assign DisplayName="Assign Excluded" sap:VirtualizedContainerService.HintSize="255,57">
                    <p1:Assign.To>
                      <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.Response.ExcludedCandidates]</p1:OutArgument>
                    </p1:Assign.To>
                    <p1:Assign.Value>
                      <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.TiedCandidate]</p1:InArgument>
                    </p1:Assign.Value>
                  </p1:Assign>
                  <SendReply DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="255,86">
                    <SendReply.Request>
                      <Receive x:Name="__ReferenceID2" sap:VirtualizedContainerService.HintSize="255,86" OperationName="GetStatus" ServiceContractName="p:ICalculate">
                        <Receive.CorrelatesOn>
                          <XPathMessageQuery x:Key="key1">
                            <XPathMessageQuery.Namespaces>
                              <ssx:XPathMessageContextMarkup>
                                <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                              </ssx:XPathMessageContextMarkup>
                            </XPathMessageQuery.Namespaces>sm:body()/xgSc:GetStatus/xgSc:ProcessId</XPathMessageQuery>
                        </Receive.CorrelatesOn>
                        <Receive.CorrelationInitializers>
                          <RequestReplyCorrelationInitializer CorrelationHandle="[__handleGetStatus]" />
                        </Receive.CorrelationInitializers>
                        <ReceiveParametersContent>
                          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId" />
                        </ReceiveParametersContent>
                      </Receive>
                    </SendReply.Request>
                    <SendParametersContent>
                      <p1:InArgument x:TypeArguments="vce1:MCalculateResponse" x:Key="Response">[Process.Response]</p1:InArgument>
                    </SendParametersContent>
                  </SendReply>
                </p1:Sequence>
              </p1:PickBranch>
              <p1:PickBranch DisplayName="Resume Tie PickBranch" sap:VirtualizedContainerService.HintSize="516,1244">
                <p1:PickBranch.Variables>
                  <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handle2" />
                </p1:PickBranch.Variables>
                <p1:PickBranch.Trigger>
                  <p1:Sequence sap:VirtualizedContainerService.HintSize="486,210">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <x:Reference>__ReferenceID3</x:Reference>
                  </p1:Sequence>
                </p1:PickBranch.Trigger>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="486,532">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:If Condition="[Not ResolveTieRequest.SelectedCandidate Is Nothing]" sap:VirtualizedContainerService.HintSize="464,282">
                    <p1:If.Then>
                      <p1:Sequence sap:VirtualizedContainerService.HintSize="301,181">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg3:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.ExclusionTieResolved]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                      </p1:Sequence>
                    </p1:If.Then>
                  </p1:If>
                  <SendReply DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="464,86">
                    <SendReply.Request>
                      <Receive x:Name="__ReferenceID3" sap:VirtualizedContainerService.HintSize="255,86" OperationName="ResolveTie" ServiceContractName="p:ICalculate">
                        <Receive.CorrelatesOn>
                          <XPathMessageQuery x:Key="key1">
                            <XPathMessageQuery.Namespaces>
                              <ssx:XPathMessageContextMarkup>
                                <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                              </ssx:XPathMessageContextMarkup>
                            </XPathMessageQuery.Namespaces>sm:body()/xgSc:ResolveTie/xgSc:ProcessId</XPathMessageQuery>
                        </Receive.CorrelatesOn>
                        <Receive.CorrelationInitializers>
                          <RequestReplyCorrelationInitializer CorrelationHandle="[__handle2]" />
                        </Receive.CorrelationInitializers>
                        <ReceiveParametersContent>
                          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId" />
                          <p1:OutArgument x:TypeArguments="vce1:MResolveRequest" x:Key="Request">[ResolveTieRequest]</p1:OutArgument>
                        </ReceiveParametersContent>
                      </Receive>
                    </SendReply.Request>
                  </SendReply>
                </p1:Sequence>
              </p1:PickBranch>
              <p1:PickBranch DisplayName="Get Result Branch" sap:VirtualizedContainerService.HintSize="516,1244">
                <p1:PickBranch.Variables>
                  <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handle1" />
                </p1:PickBranch.Variables>
                <p1:PickBranch.Trigger>
                  <p1:Sequence sap:VirtualizedContainerService.HintSize="486,210">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <x:Reference>__ReferenceID4</x:Reference>
                  </p1:Sequence>
                </p1:PickBranch.Trigger>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="486,920">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:If Condition="[Process.State = CalculateState.Finished]" sap:VirtualizedContainerService.HintSize="464,670">
                    <p1:If.Then>
                      <p1:Sequence sap:VirtualizedContainerService.HintSize="301,569">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg3:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.Response.State]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Delivered]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                        <p1:Assign DisplayName="Assign Candidates" sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.Response.Candidates]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.CalculateObject.Candidates]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                        <p1:Assign DisplayName="Assign Distributions" sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="scg3:List(vce1:MDistribution)">[Process.Response.Distributions]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="scg3:List(vce1:MDistribution)">[Process.CalculateObject.Distributions]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                        <p1:Assign DisplayName="Assign Distributions" sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.Response.ElectedCandidates]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.CalculateObject.ElectedCandidates]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                        <p1:Assign DisplayName="Assign Distributions" sap:VirtualizedContainerService.HintSize="242,57">
                          <p1:Assign.To>
                            <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.Response.ExcludedCandidates]</p1:OutArgument>
                          </p1:Assign.To>
                          <p1:Assign.Value>
                            <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.CalculateObject.ExcludedCandidates]</p1:InArgument>
                          </p1:Assign.Value>
                        </p1:Assign>
                      </p1:Sequence>
                    </p1:If.Then>
                  </p1:If>
                  <SendReply DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="464,86">
                    <SendReply.Request>
                      <Receive x:Name="__ReferenceID4" sap:VirtualizedContainerService.HintSize="255,86" OperationName="GetResult" ServiceContractName="p:ICalculate">
                        <Receive.CorrelatesOn>
                          <XPathMessageQuery x:Key="key1">
                            <XPathMessageQuery.Namespaces>
                              <ssx:XPathMessageContextMarkup>
                                <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                              </ssx:XPathMessageContextMarkup>
                            </XPathMessageQuery.Namespaces>sm:body()/xgSc:GetResult/xgSc:ProcessId</XPathMessageQuery>
                        </Receive.CorrelatesOn>
                        <Receive.CorrelationInitializers>
                          <RequestReplyCorrelationInitializer CorrelationHandle="[__handle1]" />
                        </Receive.CorrelationInitializers>
                        <ReceiveParametersContent>
                          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId" />
                        </ReceiveParametersContent>
                      </Receive>
                    </SendReply.Request>
                    <SendParametersContent>
                      <p1:InArgument x:TypeArguments="vce1:MCalculateResponse" x:Key="Response">[Process.Response]</p1:InArgument>
                    </SendParametersContent>
                  </SendReply>
                </p1:Sequence>
              </p1:PickBranch>
              <p1:PickBranch DisplayName="PickBranch Cancel" sap:VirtualizedContainerService.HintSize="307,1244">
                <p1:PickBranch.Variables>
                  <p1:Variable x:TypeArguments="CorrelationHandle" Name="__handle1" />
                </p1:PickBranch.Variables>
                <p1:PickBranch.Trigger>
                  <p1:Sequence sap:VirtualizedContainerService.HintSize="277,210">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <x:Reference>__ReferenceID5</x:Reference>
                  </p1:Sequence>
                </p1:PickBranch.Trigger>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="277,307">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:Assign sap:VirtualizedContainerService.HintSize="255,57">
                    <p1:Assign.To>
                      <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                    </p1:Assign.To>
                    <p1:Assign.Value>
                      <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Cancel]</p1:InArgument>
                    </p1:Assign.Value>
                  </p1:Assign>
                  <SendReply DisplayName="SendReplyToReceive" sap:VirtualizedContainerService.HintSize="255,86">
                    <SendReply.Request>
                      <Receive x:Name="__ReferenceID5" sap:VirtualizedContainerService.HintSize="255,86" OperationName="Cancel" ServiceContractName="p:ICalculate">
                        <Receive.CorrelatesOn>
                          <XPathMessageQuery x:Key="key1">
                            <XPathMessageQuery.Namespaces>
                              <ssx:XPathMessageContextMarkup>
                                <x:String x:Key="xgSc">http://tempuri.org/</x:String>
                              </ssx:XPathMessageContextMarkup>
                            </XPathMessageQuery.Namespaces>sm:body()/xgSc:Cancel/xgSc:ProcessId</XPathMessageQuery>
                        </Receive.CorrelatesOn>
                        <Receive.CorrelationInitializers>
                          <RequestReplyCorrelationInitializer CorrelationHandle="[__handle1]" />
                        </Receive.CorrelationInitializers>
                        <ReceiveParametersContent>
                          <p1:OutArgument x:TypeArguments="s:Guid" x:Key="ProcessId" />
                        </ReceiveParametersContent>
                      </Receive>
                    </SendReply.Request>
                  </SendReply>
                </p1:Sequence>
              </p1:PickBranch>
            </p1:Pick>
            <p1:If Condition="[Process.State = CalculateState.ExclusionTieResolved Or Process.State = CalculateState.Starting]" sap:VirtualizedContainerService.HintSize="2227,639">
              <p1:If.Then>
                <p1:Sequence sap:VirtualizedContainerService.HintSize="486,538">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg3:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <p1:If Condition="[Process.State = CalculateState.Starting]" sap:VirtualizedContainerService.HintSize="464,228">
                    <p1:If.Then>
                      <p1:InvokeMethod DisplayName="Queue Distribution of 1st Preferences" sap:VirtualizedContainerService.HintSize="219,127" MethodName="QueueDistributionOf1stPreferences">
                        <p1:InvokeMethod.TargetObject>
                          <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                        </p1:InvokeMethod.TargetObject>
                      </p1:InvokeMethod>
                    </p1:If.Then>
                    <p1:If.Else>
                      <p1:InvokeMethod DisplayName="Exclude Candidate" sap:VirtualizedContainerService.HintSize="220,127" MethodName="ExcludeCandidate">
                        <p1:InvokeMethod.TargetObject>
                          <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                        </p1:InvokeMethod.TargetObject>
                        <p1:InArgument x:TypeArguments="vce1:MCandidate">[ResolveTieRequest.SelectedCandidate]</p1:InArgument>
                      </p1:InvokeMethod>
                    </p1:If.Else>
                  </p1:If>
                  <p1:Assign sap:VirtualizedContainerService.HintSize="464,57">
                    <p1:Assign.To>
                      <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                    </p1:Assign.To>
                    <p1:Assign.Value>
                      <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Working]</p1:InArgument>
                    </p1:Assign.Value>
                  </p1:Assign>
                  <p1:Flowchart DisplayName="Preferential Flowchart" sap:VirtualizedContainerService.HintSize="1145,1590">
                    <p1:Flowchart.Variables>
                      <p1:Variable x:TypeArguments="vcb:BallotPaperBL[]" Name="BallotPapers" />
                      <p1:Variable x:TypeArguments="s:Int32[]" Name="Preferences" />
                      <p1:Variable x:TypeArguments="x:Int32" Name="Quota" />
                      <p1:Variable x:TypeArguments="scg3:List(vce1:MCandidate)" Name="Elected" />
                      <p1:Variable x:TypeArguments="vce1:MCandidate" Name="ElectedCandidate" />
                    </p1:Flowchart.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <av:Point x:Key="ShapeLocation">540,2.5</av:Point>
                        <av:Size x:Key="ShapeSize">60,75</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">570,77.5 570,102.5</av:PointCollection>
                        <x:Double x:Key="Height">1553.5</x:Double>
                        <x:Double x:Key="Width">1131</x:Double>
                      </scg3:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <p1:Flowchart.StartNode>
                      <x:Reference>__ReferenceID17</x:Reference>
                    </p1:Flowchart.StartNode>
                    <p1:FlowStep x:Name="__ReferenceID6">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">296,186.5</av:Point>
                          <av:Size x:Key="ShapeSize">208,127</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">400,313.5 400,336.5</av:PointCollection>
                        </scg3:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <p1:InvokeMethod DisplayName="RunNextQueuedDistribution" sap:VirtualizedContainerService.HintSize="208,127" MethodName="RunNextQueuedDistribution">
                        <p1:InvokeMethod.TargetObject>
                          <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                        </p1:InvokeMethod.TargetObject>
                      </p1:InvokeMethod>
                      <p1:FlowStep.Next>
                        <p1:FlowStep x:Name="__ReferenceID9">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">296,336.5</av:Point>
                              <av:Size x:Key="ShapeSize">208,127</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">400,463.5 400,492.5</av:PointCollection>
                            </scg3:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <p1:InvokeMethod DisplayName="Get passed-quota candidates" sap:VirtualizedContainerService.HintSize="208,127" MethodName="GetPassedQuotaCandidates">
                            <p1:InvokeMethod.Result>
                              <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Elected]</p1:OutArgument>
                            </p1:InvokeMethod.Result>
                            <p1:InvokeMethod.TargetObject>
                              <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                            </p1:InvokeMethod.TargetObject>
                          </p1:InvokeMethod>
                          <p1:FlowStep.Next>
                            <p1:FlowDecision x:Name="__ReferenceID10" Condition="[Elected.Count = 0]" sap:VirtualizedContainerService.HintSize="60,75">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">370,492.5</av:Point>
                                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                                  <x:String x:Key="FalseLabel">Elected</x:String>
                                  <x:String x:Key="TrueLabel">NoOne Elected</x:String>
                                  <av:PointCollection x:Key="TrueConnector">370,530 170,530 170,566.5</av:PointCollection>
                                  <av:PointCollection x:Key="FalseConnector">430,530 690,530 690,836.5</av:PointCollection>
                                </scg3:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <p1:FlowDecision.True>
                                <p1:FlowStep x:Name="__ReferenceID11">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">66,566.5</av:Point>
                                      <av:Size x:Key="ShapeSize">208,127</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">170,693.5 170,712.5</av:PointCollection>
                                    </scg3:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <p1:InvokeMethod DisplayName="Get candidates with the lowest votes" sap:VirtualizedContainerService.HintSize="208,127" MethodName="GetCandidatesWithLowestVotes">
                                    <p1:InvokeMethod.Result>
                                      <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Excluded]</p1:OutArgument>
                                    </p1:InvokeMethod.Result>
                                    <p1:InvokeMethod.TargetObject>
                                      <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                    </p1:InvokeMethod.TargetObject>
                                  </p1:InvokeMethod>
                                  <p1:FlowStep.Next>
                                    <p1:FlowDecision x:Name="__ReferenceID16" Condition="[Excluded.Count = 1]" sap:VirtualizedContainerService.HintSize="60,75">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">140,712.5</av:Point>
                                          <av:Size x:Key="ShapeSize">60,75</av:Size>
                                          <x:String x:Key="TrueLabel">One excluded</x:String>
                                          <x:String x:Key="FalseLabel">More than 1 excluded</x:String>
                                          <av:PointCollection x:Key="TrueConnector">140,750 130,750 130,1056.5</av:PointCollection>
                                          <av:PointCollection x:Key="FalseConnector">200,750 350,750 350,772.5</av:PointCollection>
                                        </scg3:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <p1:FlowDecision.True>
                                        <p1:FlowStep x:Name="__ReferenceID7">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">26,1056.5</av:Point>
                                              <av:Size x:Key="ShapeSize">208,127</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">26,1120 2,1120 2,86.7233333333333 555,86.7233333333333 555,102.5</av:PointCollection>
                                            </scg3:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <p1:InvokeMethod DisplayName="Exclude Candidate" sap:VirtualizedContainerService.HintSize="208,127" MethodName="ExcludeCandidate">
                                            <p1:InvokeMethod.TargetObject>
                                              <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                            </p1:InvokeMethod.TargetObject>
                                            <p1:InArgument x:TypeArguments="vce1:MCandidate">[Excluded(0)]</p1:InArgument>
                                          </p1:InvokeMethod>
                                          <p1:FlowStep.Next>
                                            <p1:FlowDecision x:Name="__ReferenceID17" Condition="[Not (Process.CalculateObject.ContinuingCandidates.Count = 1 And Process.CalculateObject.VacanciesToFill = 1)]" sap:VirtualizedContainerService.HintSize="60,75">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">540,102.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                  <x:String x:Key="TrueLabel">Can Continue</x:String>
                                                  <x:String x:Key="FalseLabel">No more candidate left</x:String>
                                                  <av:PointCollection x:Key="FalseConnector">600,140 820,140 820,271.5</av:PointCollection>
                                                  <av:PointCollection x:Key="TrueConnector">540,140 510,140 510,110 304,110 304,170 274,170</av:PointCollection>
                                                </scg3:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <p1:FlowDecision.True>
                                                <p1:FlowStep x:Name="__ReferenceID22">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">66,106.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">208,127</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">170,233.5 170,250 296,250</av:PointCollection>
                                                    </scg3:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <p1:InvokeMethod sap:VirtualizedContainerService.HintSize="208,127" MethodName="SaveData">
                                                    <p1:InvokeMethod.TargetObject>
                                                      <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                                    </p1:InvokeMethod.TargetObject>
                                                  </p1:InvokeMethod>
                                                  <p1:FlowStep.Next>
                                                    <x:Reference>__ReferenceID6</x:Reference>
                                                  </p1:FlowStep.Next>
                                                </p1:FlowStep>
                                              </p1:FlowDecision.True>
                                              <p1:FlowDecision.False>
                                                <p1:FlowStep x:Name="__ReferenceID19">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">699,271.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">242,57</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">820,328.5 820,900 794,900</av:PointCollection>
                                                    </scg3:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                    <p1:Assign.To>
                                                      <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Elected]</p1:OutArgument>
                                                    </p1:Assign.To>
                                                    <p1:Assign.Value>
                                                      <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.CalculateObject.ContinuingCandidates]</p1:InArgument>
                                                    </p1:Assign.Value>
                                                  </p1:Assign>
                                                  <p1:FlowStep.Next>
                                                    <p1:FlowStep x:Name="__ReferenceID8">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">586,836.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">208,127</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">690,963.5 690,991.5</av:PointCollection>
                                                        </scg3:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <p1:InvokeMethod DisplayName="Elect candidate" sap:VirtualizedContainerService.HintSize="208,127" MethodName="ElectCandidate">
                                                        <p1:InvokeMethod.TargetObject>
                                                          <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                                        </p1:InvokeMethod.TargetObject>
                                                        <p1:InArgument x:TypeArguments="vce1:MCandidate">[Elected(0)]</p1:InArgument>
                                                      </p1:InvokeMethod>
                                                      <p1:FlowStep.Next>
                                                        <p1:FlowStep x:Name="__ReferenceID12">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">569,991.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">242,57</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">690,1048.5 690,1078.5 690,1121.5</av:PointCollection>
                                                            </scg3:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                            <p1:Assign.To>
                                                              <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                                                            </p1:Assign.To>
                                                            <p1:Assign.Value>
                                                              <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Finished]</p1:InArgument>
                                                            </p1:Assign.Value>
                                                          </p1:Assign>
                                                          <p1:FlowStep.Next>
                                                            <p1:FlowStep x:Name="__ReferenceID23">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">569,1121.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">242,57</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">690,1178.5 690,1208.5 690,1276.5</av:PointCollection>
                                                                </scg3:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                                <p1:Assign.To>
                                                                  <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.CalculateObject.CalculationState]</p1:OutArgument>
                                                                </p1:Assign.To>
                                                                <p1:Assign.Value>
                                                                  <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Finished]</p1:InArgument>
                                                                </p1:Assign.Value>
                                                              </p1:Assign>
                                                              <p1:FlowStep.Next>
                                                                <p1:FlowStep x:Name="__ReferenceID21">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">586,1276.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">208,127</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">250,253.5 250,290 366,290</av:PointCollection>
                                                                    </scg3:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <p1:InvokeMethod sap:VirtualizedContainerService.HintSize="208,127" MethodName="SaveData">
                                                                    <p1:InvokeMethod.TargetObject>
                                                                      <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                                                    </p1:InvokeMethod.TargetObject>
                                                                  </p1:InvokeMethod>
                                                                </p1:FlowStep>
                                                              </p1:FlowStep.Next>
                                                            </p1:FlowStep>
                                                          </p1:FlowStep.Next>
                                                        </p1:FlowStep>
                                                      </p1:FlowStep.Next>
                                                    </p1:FlowStep>
                                                  </p1:FlowStep.Next>
                                                </p1:FlowStep>
                                              </p1:FlowDecision.False>
                                            </p1:FlowDecision>
                                          </p1:FlowStep.Next>
                                        </p1:FlowStep>
                                      </p1:FlowDecision.True>
                                      <p1:FlowDecision.False>
                                        <p1:FlowDecision x:Name="__ReferenceID13" Condition="[Process.CalculateObject.TieMethodType = TieMethodType.Automatic]" sap:VirtualizedContainerService.HintSize="60,75">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">320,772.5</av:Point>
                                              <av:Size x:Key="ShapeSize">60,75</av:Size>
                                              <x:String x:Key="FalseLabel">Manual</x:String>
                                              <x:String x:Key="TrueLabel">Automatic</x:String>
                                              <av:PointCollection x:Key="FalseConnector">380,810 430,810 430,1051.5</av:PointCollection>
                                              <av:PointCollection x:Key="TrueConnector">320,810 280,810 280,896.5</av:PointCollection>
                                            </scg3:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <p1:FlowDecision.True>
                                            <p1:FlowStep x:Name="__ReferenceID18">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">176,896.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">208,127</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">280,1023.5 280,1120 234,1120</av:PointCollection>
                                                </scg3:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <p1:InvokeMethod DisplayName="Resolve Tied exclusion" sap:VirtualizedContainerService.HintSize="208,127" MethodName="ResolvePRExclusionTie">
                                                <p1:InvokeMethod.Result>
                                                  <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Excluded]</p1:OutArgument>
                                                </p1:InvokeMethod.Result>
                                                <p1:InvokeMethod.TargetObject>
                                                  <p1:InArgument x:TypeArguments="vscw:CalcWrapper">[Process.CalculateObject]</p1:InArgument>
                                                </p1:InvokeMethod.TargetObject>
                                                <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Excluded]</p1:InArgument>
                                              </p1:InvokeMethod>
                                              <p1:FlowStep.Next>
                                                <x:Reference>__ReferenceID7</x:Reference>
                                              </p1:FlowStep.Next>
                                            </p1:FlowStep>
                                          </p1:FlowDecision.True>
                                          <p1:FlowDecision.False>
                                            <p1:FlowStep x:Name="__ReferenceID15">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">309,1051.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">242,57</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">430,1108.5 430,1138.5 430,1141.5</av:PointCollection>
                                                </scg3:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                <p1:Assign.To>
                                                  <p1:OutArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Process.TiedCandidate]</p1:OutArgument>
                                                </p1:Assign.To>
                                                <p1:Assign.Value>
                                                  <p1:InArgument x:TypeArguments="scg3:List(vce1:MCandidate)">[Excluded]</p1:InArgument>
                                                </p1:Assign.Value>
                                              </p1:Assign>
                                              <p1:FlowStep.Next>
                                                <p1:FlowStep x:Name="__ReferenceID14">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">309,1141.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">242,57</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">430,1198.5 420,1198.5 420,1219</av:PointCollection>
                                                    </scg3:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                    <p1:Assign.To>
                                                      <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                                                    </p1:Assign.To>
                                                    <p1:Assign.Value>
                                                      <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.ExclusionTie]</p1:InArgument>
                                                    </p1:Assign.Value>
                                                  </p1:Assign>
                                                  <p1:FlowStep.Next>
                                                    <p1:FlowStep x:Name="__ReferenceID20">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">320,1219</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                        </scg3:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <p1:Delay Duration="[New TimeSpan(0, 0, 1)]" sap:VirtualizedContainerService.HintSize="200,22" />
                                                    </p1:FlowStep>
                                                  </p1:FlowStep.Next>
                                                </p1:FlowStep>
                                              </p1:FlowStep.Next>
                                            </p1:FlowStep>
                                          </p1:FlowDecision.False>
                                        </p1:FlowDecision>
                                      </p1:FlowDecision.False>
                                    </p1:FlowDecision>
                                  </p1:FlowStep.Next>
                                </p1:FlowStep>
                              </p1:FlowDecision.True>
                              <p1:FlowDecision.False>
                                <x:Reference>__ReferenceID8</x:Reference>
                              </p1:FlowDecision.False>
                            </p1:FlowDecision>
                          </p1:FlowStep.Next>
                        </p1:FlowStep>
                      </p1:FlowStep.Next>
                    </p1:FlowStep>
                    <x:Reference>__ReferenceID9</x:Reference>
                    <x:Reference>__ReferenceID10</x:Reference>
                    <x:Reference>__ReferenceID11</x:Reference>
                    <x:Reference>__ReferenceID12</x:Reference>
                    <x:Reference>__ReferenceID13</x:Reference>
                    <x:Reference>__ReferenceID14</x:Reference>
                    <x:Reference>__ReferenceID15</x:Reference>
                    <x:Reference>__ReferenceID16</x:Reference>
                    <x:Reference>__ReferenceID7</x:Reference>
                    <x:Reference>__ReferenceID8</x:Reference>
                    <x:Reference>__ReferenceID17</x:Reference>
                    <x:Reference>__ReferenceID18</x:Reference>
                    <x:Reference>__ReferenceID19</x:Reference>
                    <x:Reference>__ReferenceID20</x:Reference>
                    <x:Reference>__ReferenceID21</x:Reference>
                    <x:Reference>__ReferenceID22</x:Reference>
                    <x:Reference>__ReferenceID23</x:Reference>
                  </p1:Flowchart>
                </p1:Sequence>
              </p1:If.Then>
            </p1:If>
          </p1:Sequence>
        </p1:TryCatch.Try>
        <p1:TryCatch.Catches>
          <p1:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="2253,20">
            <sap:WorkflowViewStateService.ViewState>
              <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg3:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <p1:ActivityAction x:TypeArguments="s:Exception">
              <p1:ActivityAction.Argument>
                <p1:DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </p1:ActivityAction.Argument>
              <p1:Sequence sap:VirtualizedContainerService.HintSize="2247,294">
                <sap:WorkflowViewStateService.ViewState>
                  <scg3:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg3:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                  <p1:Assign.To>
                    <p1:OutArgument x:TypeArguments="vce1:CalculateState">[Process.State]</p1:OutArgument>
                  </p1:Assign.To>
                  <p1:Assign.Value>
                    <p1:InArgument x:TypeArguments="vce1:CalculateState">[CalculateState.Error]</p1:InArgument>
                  </p1:Assign.Value>
                </p1:Assign>
                <p1:Assign sap:VirtualizedContainerService.HintSize="242,57">
                  <p1:Assign.To>
                    <p1:OutArgument x:TypeArguments="x:String">[Process.Response.Error]</p1:OutArgument>
                  </p1:Assign.To>
                  <p1:Assign.Value>
                    <p1:InArgument x:TypeArguments="x:String">[exception.Message]</p1:InArgument>
                  </p1:Assign.Value>
                </p1:Assign>
              </p1:Sequence>
            </p1:ActivityAction>
          </p1:Catch>
        </p1:TryCatch.Catches>
      </p1:TryCatch>
    </p1:DoWhile>
  </p1:Sequence>
</WorkflowService>